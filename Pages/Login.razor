@page "/"
@inject IJSRuntime JSRuntime;
@inject NavigationManager navMgr;

<div id="firebaseui-auth-container"></div>

@code {
    private class UserId { public string uid; };

    protected override Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            var promise = new PromiseHandler<UserId>();
            JSRuntime.InvokeAsync<Dictionary<string, object>>("firebaseLogin", DotNetObjectReference.Create(promise));
            promise.ToObservable().Subscribe((UserId u) =>
            {
                Globals.uid = u.uid;
                navMgr.NavigateTo("/player");
            });

        }
        return base.OnAfterRenderAsync(firstRender);
    }

}
